---
title: 'åˆ¤æ–­é€»è¾‘è¶Šå†™è¶Šä¹±ï¼Œæˆ‘å¹²è„†åšäº†ä¸ªè‡ªå·±çš„è§„åˆ™å¼•æ“Ž'
publishDate: '2025-04-30 09:13:17'
description: 'è¿™ç¯‡æ–‡ç« ä»‹ç»äº†ä¸€ä¸ªè½»é‡ã€æ˜“ç”¨çš„ PHP è§„åˆ™å¼•æ“Žã€‚å®ƒæ—¨åœ¨å¸®åŠ©å¼€å‘è€…ä»Žæ··ä¹±çš„ if/else ä¸­è§£æ”¾å‡ºæ¥ï¼Œä»¥ç»“æž„åŒ–çš„æ–¹å¼å¤„ç†å¤šæ¡ä»¶åˆ¤æ–­ã€‚é€‚ç”¨äºŽä¸šåŠ¡è§„åˆ™ã€æ•°æ®æ ¡éªŒç­‰åœºæ™¯ï¼Œæ”¯æŒè§„åˆ™æ‰©å±•ã€ç»„åˆåˆ¤æ–­'
tags:
  - PHP
  - Composer
language: 'ä¸­æ–‡'
heroImage: { src: './cover/php.png', color: '#573ba2' }
draft: false
slug: 'da4e917a'
---

ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰è¿™ç§æ„Ÿè§‰ï¼šä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†åˆ¤æ–­æ¡ä»¶å´ä¸€å¤§å †ã€‚  
ä»€ä¹ˆç”¨æˆ·çŠ¶æ€ã€é…ç½®é¡¹ã€å•†å“å±žæ€§ã€ä¼šå‘˜ç­‰çº§â€¦â€¦  
ä¸€å¤§å † `if`â€‹ / `else`â€‹ äº¤ç»‡åœ¨ä¸€èµ·ï¼Œè¶Šå†™è¶Šä¹±ï¼Œç¨å¾®æ”¹ä¸€ä¸ªé€»è¾‘å°±è¦æ‹…å¿ƒå½±å“å…¶ä»–åœ°æ–¹ã€‚

æˆ‘ä¹‹å‰å°±é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œä¸€å¼€å§‹è¿˜èƒ½å¿ï¼ŒåŽæ¥å¹²è„†å†³å®šï¼š**ä¸å¦‚è‡ªå·±å†™ä¸€ä¸ªç®€å•çš„è§„åˆ™å¼•æ“Žï¼Œä¸“é—¨ç”¨æ¥å¤„ç†è¿™äº›ç»„åˆåˆ¤æ–­ã€‚**

äºŽæ˜¯å°±æœ‰äº†è¿™ä¸ªé¡¹ç›®ï¼š[hejunjie/simple-rule-engine](https://github.com/zxc7563598/php-simple-rule-engine)

---

## ðŸš€ è¿™ä¸ªè§„åˆ™å¼•æ“Žèƒ½å¹²å˜›ï¼Ÿ

ä¸€å¥è¯æ€»ç»“ï¼š  
**è¿™æ˜¯ä¸€ä¸ªè½»é‡ã€æ˜“ç”¨çš„ PHP è§„åˆ™å¼•æ“Žï¼Œæ”¯æŒå¤šæ¡ä»¶ç»„åˆã€åŠ¨æ€è§„åˆ™æ‰§è¡Œï¼Œé€‚åˆä¸šåŠ¡è§„åˆ™åˆ¤æ–­ã€æ•°æ®æ ¡éªŒç­‰åœºæ™¯ã€‚**

é€‚åˆç”¨åœ¨ä½ é¡¹ç›®ä¸­çš„è¿™äº›åœ°æ–¹ï¼š

- å¤æ‚ä¸šåŠ¡çš„å¤šæ¡ä»¶åˆ¤æ–­ï¼ˆæ¯”å¦‚ç”¨æˆ·æ˜¯å¦æ»¡è¶³æŸä¸ªæ´»åŠ¨è¦æ±‚ï¼‰
- æ•°æ®å…¥åº“å‰çš„è§„åˆ™æ ¡éªŒ
- è‡ªå®šä¹‰é€»è¾‘çš„é…ç½®åŒ–ã€ç»“æž„åŒ–å¤„ç†
- å†™å¾—ä¸€æ‰‹ if åœ°ç‹±ï¼Œæƒ³æŠ½å‡ºæ¥æ•´æ•´é½é½ ðŸ˜…

---

## ðŸŒŸ ä¸ºä»€ä¹ˆè¦åšå®ƒï¼Ÿ

åœ¨å®žé™…ä¸šåŠ¡ä¸­ï¼Œå¾ˆå¤šä¸šåŠ¡åˆ¤æ–­é€»è¾‘å…¶å®žéƒ½å¯ä»¥å½’çº³ä¸ºï¼šâ€œä¸€å †å­—æ®µ + ä¸€äº›è§„åˆ™ + å¤šä¸ªæ¡ä»¶ç»„åˆâ€ã€‚

åŽŸæœ¬æˆ‘ä»¬å¯èƒ½æ˜¯è¿™ä¹ˆå†™çš„ï¼š

```php
if (
    $user['status'] === 'active' &&
    $user['age'] >= 18 &&
    in_array($user['role'], ['admin', 'editor'])
) {
    // ...
}
```

çŽ°åœ¨å¯ä»¥è¿™æ ·ï¼š

```php
// å®šä¹‰è§„åˆ™
$rules = [
    new Rule('age', '>=', 18, 'å¹´é¾„å¿…é¡»å¤§äºŽç­‰äºŽ18å²'),
    new Rule('status', '==', 'active', 'çŠ¶æ€å¿…é¡»ä¸ºactive'),
    new Rule('role', 'in', ['admin', 'editor'], 'è§’è‰²éœ€æ‹¥æœ‰æƒé™'),
];
// è¯„ä¼°ç»“æžœ
$result = Engine::evaluate($rules, $user, 'AND'); // è¿”å›ž true æˆ– false

// èŽ·å–è¯¦ç»†è¯„ä¼°ä¿¡æ¯(ç”¨äºŽèŽ·å–æ¯æ¡è§„åˆ™çš„æ‰§è¡Œæƒ…å†µ)
$details = Engine::evaluateWithDetails($rules, $user);
/*
è¿”å›žç¤ºä¾‹ï¼š
[
    ['description' => 'å¹´é¾„å¿…é¡»å¤§äºŽç­‰äºŽ18å²', 'passed' => true],
    ['description' => 'çŠ¶æ€å¿…é¡»ä¸ºactive', 'passed' => true],
    ['description' => 'è§’è‰²éœ€æ‹¥æœ‰æƒé™', 'passed' => true]
]
*/
```

æ˜¯ä¸æ˜¯æ•´æ´å¤šäº†ï¼Ÿè€Œä¸”å¦‚æžœä½ æŠŠè§„åˆ™æ”¾æ•°æ®åº“ï¼Œå°±èƒ½å®žçŽ°â€œä¸šåŠ¡åˆ¤æ–­é…ç½®åŒ–â€äº†ã€‚

---

## ðŸ§© é¡¹ç›®ç‰¹ç‚¹

- âœ… **è½»é‡æ˜“ç”¨**ï¼šæ— ä¾èµ–ï¼Œæ— æ¡†æž¶é™åˆ¶ï¼Œç®€å•å‡ è¡Œå°±èƒ½ç”¨
- ðŸ”Œ **å·¥åŽ‚æ³¨å†Œæœºåˆ¶**ï¼šä½ å¯ä»¥è‡ªå·±å†™æ–°çš„æ“ä½œç¬¦ï¼ˆOperatorï¼‰æ³¨å†Œè¿›æ¥
- ðŸ“¦ **å†…ç½®å¸¸ç”¨æ“ä½œç¬¦**ï¼šå¤šæ•°å¸¸ç”¨æ“ä½œç¬¦éƒ½æ”¯æŒï¼ˆå¯è§æ–‡ç« æœ«å°¾æ“ä½œç¬¦æ”¯æŒåˆ—è¡¨ï¼‰
- ðŸ§  **å¯ç»„åˆã€å¤šæ¡ä»¶æ”¯æŒ**ï¼šæ”¯æŒ AND / OR å…³ç³»ç»„åˆï¼Œæ‰©å±•å¤šå¥—è§„åˆ™é€»è¾‘å¾ˆæ–¹ä¾¿

---

## ðŸ“¦ å®‰è£…æ–¹æ³•

```bash
composer require hejunjie/simple-rule-engine
```

---

## ðŸ› ï¸ ç¤ºä¾‹ä»£ç 

```php
use Hejunjie\SimpleRuleEngine\Rule;
use Hejunjie\SimpleRuleEngine\Engine;

// å®šä¹‰è§„åˆ™
$rules = [
    new Rule('age', '>=', 18, 'å¹´é¾„å¿…é¡»å¤§äºŽç­‰äºŽ18å²'),
    new Rule('status', '==', 'active', 'çŠ¶æ€å¿…é¡»ä¸ºactive'),
    new Rule('role', 'in', ['admin', 'editor'], 'è§’è‰²éœ€æ‹¥æœ‰æƒé™'),
];

$data = ['age' => 20, 'country' => 'China'];

// ç®€å•åˆ¤æ–­æ˜¯å¦é€šè¿‡å…¨éƒ¨è§„åˆ™
if (Engine::evaluate($rules, $data, 'AND')) {
    echo 'ç¬¦åˆè§„åˆ™';
}

// èŽ·å–æ¯ä¸€æ¡è§„åˆ™æ˜¯å¦é€šè¿‡çš„è¯¦æƒ…
foreach (Engine::evaluateWithDetails($rules, $data) as $detail) {
    echo $detail['description'] . 'ï¼š' . ($detail['passed'] ? 'âœ… é€šè¿‡' : 'âŒ æœªé€šè¿‡') . PHP_EOL;
}
```

---

## ðŸ”Œ è‡ªå®šä¹‰æ“ä½œç¬¦

ä½ å¯ä»¥è‡ªç”±çš„åŽ»å®žçŽ°è‡ªå·±çš„åˆ¤æ–­é€»è¾‘ï¼ŒæŒ‡å®šä¸€ä¸ªæ“ä½œç¬¦ï¼Œå¹¶è‡ªç”±çš„æ’å…¥åˆ°ä½ çš„è§„åˆ™ä¸­

ä»…éœ€è¦å®žçŽ° `OperatorInterface`â€‹ æŽ¥å£ï¼Œå¹¶é€šè¿‡ `OperatorFactory`â€‹ æ³¨å†Œå³å¯ï¼š

```php
use Hejunjie\SimpleRuleEngine\Interface\OperatorInterface;
use Hejunjie\SimpleRuleEngine\OperatorFactory;

class CustomizeOperator implements OperatorInterface
{
    /**
     * è¯„ä¼°æ–¹æ³•
     *
     * @param mixed $fieldValue ç”¨æˆ·è¾“å…¥æ•°æ®
     * @param mixed $ruleValue å¯¹æ¯”æ•°æ®
     *
     * @return bool
     */
    public function evaluate(mixed $fieldValue, mixed $ruleValue): bool
    {
        // TODO: å®žçŽ°åˆ¤æ–­é€»è¾‘
    }

    /**
     * æ“ä½œç¬¦åç§°
     *
     * @return string
     */
    public function name(): string
    {
        return 'customize';
    }
}

// æ³¨å†Œè‡ªå®šä¹‰æ“ä½œç¬¦ customize
$factory = OperatorFactory::getInstance();
$factory->register(new CustomizeOperator());

// å¯ä»¥åœ¨å®šä¹‰è§„åˆ™æ—¶ä½¿ç”¨ customize
$rules = [
    new Rule('field', 'customize', 'value', 'è‡ªå®šä¹‰è§„åˆ™æè¿°'),
    ...
    ...
];

// Engine::evaluate($rules, $data, 'AND')
// Engine::evaluateWithDetails($rules, $data)
```

---

## ðŸ§© å†…ç½®æ“ä½œç¬¦åˆ—è¡¨

| æ“ä½œç¬¦           | æè¿°             | é¢å¤–è¯´æ˜Ž                         |
| ---------------- | ---------------- | -------------------------------- |
| â€‹`==`â€‹           | ç­‰äºŽ             | æ—                                |
| â€‹`!=`â€‹           | ä¸ç­‰äºŽ           | æ—                                |
| â€‹`>`â€‹            | å¤§äºŽ             | æ—                                |
| â€‹`>=`â€‹           | å¤§äºŽç­‰äºŽ         | æ—                                |
| â€‹`<`â€‹            | å°äºŽ             | æ—                                |
| â€‹`<=`â€‹           | å°äºŽç­‰äºŽ         | æ—                                |
| â€‹`in`â€‹           | åŒ…å«äºŽé›†åˆä¸­     | æ•°ç»„ï¼š[å†…å®¹ 1,å†…å®¹ 2,...]        |
| â€‹`not_in`â€‹       | ä¸åŒ…å«äºŽé›†åˆä¸­   | æ•°ç»„ï¼š[å†…å®¹ 1,å†…å®¹ 2,...]        |
| â€‹`contains`â€‹     | åŒ…å«å­—ç¬¦ä¸²       | æ—                                |
| â€‹`not_contains`â€‹ | ä¸åŒ…å«å­—ç¬¦ä¸²     | æ—                                |
| â€‹`start_swith`â€‹  | ä»¥æŒ‡å®šå­—ç¬¦ä¸²å¼€å¤´ | æ—                                |
| â€‹`end_swith`â€‹    | ä»¥æŒ‡å®šå­—ç¬¦ä¸²ç»“å°¾ | æ—                                |
| â€‹`between`â€‹      | åœ¨æŒ‡å®šèŒƒå›´å†…     | æ•°ç»„ï¼š[æœ€å¤§å€¼,æœ€å°å€¼]            |
| â€‹`not_between`â€‹  | ä¸åœ¨æŒ‡å®šèŒƒå›´å†…   | æ•°ç»„ï¼š[æœ€å¤§å€¼,æœ€å°å€¼]            |
| â€‹`before_date`â€‹  | æ—¥æœŸæ—©äºŽ         | ä»»æ„å¸¸è§„æ—¥æœŸæ ¼å¼ï¼ŒåŒ…æ‹¬æ—¶é—´æˆ³å‡å¯ |
| â€‹`after_date`â€‹   | æ—¥æœŸæ™šäºŽ         | ä»»æ„å¸¸è§„æ—¥æœŸæ ¼å¼ï¼ŒåŒ…æ‹¬æ—¶é—´æˆ³å‡å¯ |
| â€‹`date_equal`â€‹   | æ—¥æœŸç›¸ç­‰         | ä»»æ„å¸¸è§„æ—¥æœŸæ ¼å¼ï¼ŒåŒ…æ‹¬æ—¶é—´æˆ³å‡å¯ |

---

## ðŸ¤” æ€»ç»“ä¸€ä¸‹

è¿™ä¸ªè§„åˆ™å¼•æ“Žä¸æ˜¯ä¸ºäº†è§£å†³å¤šä¹ˆé«˜çº§çš„æŠ€æœ¯éš¾é¢˜ï¼Œå®ƒåªæ˜¯ä¸€ä¸ª**æ›´ä¼˜é›…çš„è§£å†³æ–¹å¼**ã€‚  
å¦‚æžœä½ ä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„ if/else å›°æ‰°ï¼Œå¸Œæœ›è¿™ä¸ªå°å·¥å…·èƒ½å¸®ä¸Šä½ ä¸€ç‚¹å¿™ã€‚

---

æ¬¢è¿Ž Starã€Issueã€PRï¼Œä¸€èµ·å®Œå–„å®ƒ ðŸ™Œ  
å¦‚æžœä½ è§‰å¾—æœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµžæˆ‘ä¼šæ›´æœ‰åŠ¨åŠ›æ›´æ–°ä¸‹åŽ»ï½ž
